#include<fstream>
#include<iostream>
#include<cstring>

using namespace std;
class file{
public:
    file()
    {
        ofstream fout;
        fout.open("Pharmacy.txt");
        fout<<"Pharmacy";
        fout.close();
    }
};
class earn
{
        public:
        double profit;
        void show()
		{
		    ifstream x("sales.txt");
            if(!x)
            cout<<"EARNINGS = 0 \n";
            else
            {
                x>>profit;
                cout<<"\nTOTAL EARNINGS PER YEAR:  "<<profit<<endl;
                x.close();
            }
        }
};
class product:public virtual earn
{
        public:
           int quan;
           char name[20];
           char id[20];
           double percost;
           double persell;
           double cost;
           double sell;
           void cal()
		   {
		    cost=percost*quan;
        	sell=persell*quan;
            profit=profit +(sell-cost)*365;
		   }
           void file()
           {
               char file[20];
               strcpy(file,name);
               strcat(file,".txt");
               ofstream f(file);
               f<< "\nMedicine name: "<<name;
               f<<"\nMedicine id: "<<id;
               f<<"\ncost price of medicine: "<<percost;
               f<<"\nselling price of medicine: "<<persell;
               f<<"\nquantity: "<<quan;
               f<<"\ntotal cost: "<<cost;
               f<<"\nsell: "<<sell;
               f.close();   
           }
           void get()
           {
                int s;
                cout<<"\nnumber of medicines to add\n";
                cin>>s;
                for(int i=0;i<s;i++)
                {
                    cout<<"\nEnter medicine name: \n";
                    cin>>name;
                    cout<<"\nEnter medicine id: \n";
                    cin>>id;
                    cout<<"\nEnter cost price of medicine: \n";
                    cin>>percost;
                    cout<<"\nEnter selling price of medicine: \n";
                    cin>>persell;
                    cout<<"\nEnter the total medicine quantity: \n";
                    cin>>quan;
                    cal();
                    file();
                }
 
            }
};

class amount:public product
{
    public:
    void add()
    {
	    int ch;
	    while(1)
	    {
		    cout<<"1.)Input for Medicine\n2.)Exit\n";
		    cout<<"Enter choice\n";
		    cin>>ch;
		    if(ch==1)
            {
				get();
				ofstream x("sales.txt");
 				x<<profit;
 				x.close();
			}
			else if(ch==2)
				break;
			else
				cout<<"Invaid Option. Please re-enter\n";
		}
	}
    void update_item()
    {
        {
            char name[20];
	        char id[20];
            cout<<"\nEnter medicine name to modify\n";
            cin>>name;
            char file[20];
            strcpy(file,name);
            strcat(file,".txt");
            fstream fout(file, ios::in|ios::out);
            if(!fout)
            {
    	        cout<<"file couldn't be opened. medicine ID not found. \n";
	        }
	        else 
            {
	            cout<<"file found! \n";
                cout<<"\nupdate medicine name: \n";
  	            cin>>name;
                strcpy(file,name);
                strcat(file,".txt");
                ofstream f(file);
 	            cout<<"\nupdate cost of medicine: \n";
  	            cin>>percost;
 	            cout<<"\nupdate persell of medicine: \n";
  	            cin>>persell;
 	            cout<<"\nupdate total medicine quantity: \n";
 	            cin>>quan;
                cost=percost*quan;
                sell=persell*quan;
	            profit=profit +(sell-cost)*365;
  	            fout<<"\nmedicine name: "<<name<< "\nmedicine id: "<<id<<"\npercost of medicine: " <<percost<<"\nper sell of medicine: "<<persell<<"\nquantity: "<<quan<<"\n total cost: "<<cost<<"\nsell: "<<sell;
	            fout.close();
            }
        }
    }
};	
class order:public product
{
    public: 
    void buy()
    {
        char name[20];
        int q;
        cout<<"\nEnter medicine name\n";
        cin>>name;
        char file[20];
        strcpy(file,name);
        strcat(file,".txt");
        fstream fout(file, ios::in|ios::out);
        if(!fout)
        {
    	    cout<<"The medicine is not available. \n";
	    }
        else
        {
            cout<<"The medicine is available. \n";
            cout<<"\nEnter the quantity: ";
            cin>>q;
            if(q>quan)
            {
                cout<<"\nNOT ENOUGH STOCK!!!";
            }
            else
            {
                cout<<"\nOrder successfully placed!";
                fout<<"\nMedicine name: "<<name<<endl;
                cout<<"\nQuantity: "<<q<<endl;
                cout<<"Total amount: "<<persell*q<<endl;
            }
        } 
    }
};
void admin()
{
  while(1)
  {
 	cout<<"\n\t\t\t==============================\n";
	cout<<"\n\t\t\t  WELCOME TO THE PHARMACY STORE \n";
	cout<<"\n\t\t\t==============================\n\n";
	cout<<"\n\t\t\t* * * * * * * * * * * * * * * *\n";
 	cout<<"\n\t\t\t1. Add Medicines\n\n\t\t\t2. Show profit\n\n\t\t\t3. Search Medicine Details\n\n\t\t\t4. Modify Medicine Details\n\n\t\t\t5. Sell Medicines\n\n\t\t\t6. Exit\n";
  cout<<"\n\n\t\t\tSelect your choice: ";
  int u;
  cin>>u;
    if(u==1)
    {
        amount a;
        a.show();
        a.add();
    }
    else if(u==2)
    {
        amount d;
        d.show();
    }
    else if(u==3)
    {  
        char name[20];
        char c;
        cout<<"\nINPUT name to search\n";
        cin>>name;
        char file[20];
        strcpy(file,name);
        strcat(file,".txt");
        ifstream x(file);
        if(!x)
        {
    	    cout<<"file couldn't be opened. product ID not found. \n";
	    }
        while(x)
        {
            x.get(c);
            cout<<c;
        }
    x.close();
    }
    else if(u==4)
    {
	    amount u;
	    u.update_item();
    }
    else if(u==5)
    {
        order o;
        o.buy();
    }
}
}
int main()
{
    int ch;
    while(1)
    {
        cout<<"\n \t\t\t=========================\n";
        cout<<"\n\t\t\tPHARMACY MANAGEMENT SYSTEM  \n";
        cout<<"\n \t\t\t=========================\n\n";
        cout<<"\n \t\t\t* * * * * * * * * * * * ";
        cout<<"\n\t\t\t  1. ENTER SYSTEM";
        cout<<"\n\t\t\t  2. EXIT";
        cout<<"\n\t\t\t* * * * * * * * * * * *\n";
        cout<<"\n\t\t\t Enter Your choice: ";
        cin>>ch;
        switch(ch)
        {
            case 1:
                admin();
                break;
            case 2:
                exit(0);
                break;
            default:
                cout<<"Enter valid choice\n";
                break;
        }
    }
    return 0;
}



